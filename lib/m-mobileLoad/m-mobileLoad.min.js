!function(o){function e(e,n){this.$element=o(e),this.opts=o.extend(!0,{},t,n),this.isLoading=!1,this.isOneShow=!0,this.isOver=!1,this.total=0,this.querys=this.opts.queryParams(),this.querys.pageSize=this.opts.pageSize,this.querys.limit=this.opts.pageSize,this._init()}o(window);var t={debug:!1,url:"",model:"",initNoData:"",noData:"",errorData:"",pageIndex:1,pageSize:10,queryParams:function(){return{}},onBeforeLoad:function(e){o.loading()},onLoadSuccess:function(o,e){if(o.total=e.total,o.opts.pageIndex>1&&(o.isOneShow=!1),e.data.length){var t=template("tpl-note",e);o.$element.append(t),o.opts.pageIndex++}else o.isOver=!0,o.isOneShow?o.$element.append(o.opts.initNoData):o.$element.append(o.opts.noData);o.isLoading=!1},onLoadFail:function(o,e){o.$element.append(o.opts.errorData)},onLoadComplete:function(e,t){o.loading()}};e.prototype={constructor:e,_init:function(){var o=this;o._doLoad(),o._doScroll()},_doLoad:function(){var e=this;e.isLoading=!0,e.querys.pageIndex=e.opts.pageIndex,e.querys.offset=(e.opts.pageIndex-1)*e.opts.pageSize,e.opts.debug&&(console.log("开始加载第--"+e.opts.pageIndex+"--页"),console.log("onBeforeLoad: 数据加载前"),console.log(e)),e.opts.onBeforeLoad(e),o.ajax({url:e.opts.url,type:"post",dataType:"json",data:e.querys}).done(function(o){e.opts.debug&&(console.log("onLoadSuccess: 数据加载成功"),console.log(o)),e.opts.onLoadSuccess(e,o)}).fail(function(o){e.opts.debug&&console.log("onLoadFail: 数据加载失败"),e.opts.onLoadFail(e,o)}).always(function(o){e.opts.debug&&console.log("onLoadComplete: 数据加载完成"),e.opts.onLoadComplete(e,o)})},_doScroll:function(){var e=this;o(window).scroll(function(){var t=Math.ceil(o(window).height())+Math.ceil(o(window).scrollTop());o(document).height()<=t&&0==e.isOver&&0==e.isLoading&&(e.opts.debug&&console.log("滚动加载触发"),e._doLoad())})}},o.fn.MobileLoad=function(t){return this.each(function(){o.data(this,"plugin_MobileLoad")||o.data(this,"plugin_MobileLoad",new e(this,t))}),this}}(jQuery);