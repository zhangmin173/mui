!function(o){var e;o.fn.MobileLoad=function(n){if("string"==typeof n)return o.fn.MobileLoad.methods[n](this);var a={debug:!1,url:"",model:"",pageSize:10,pageIndex:1,total:0,isOver:!1,isOneShow:!0,initNoData:"",noData:"",query:{},isLoading:!1,onLoadStart:function(){o.loading()},onLoadFinish:function(){o.loading()},queryParams:function(){return{}},onLoad:function(e,n){n.debug&&(console.log("onLoad: 加载数据"),console.log(n.query)),o.ajax({url:n.url,data:n.query,method:"post",dataType:"json",success:function(o){n.debug&&console.log(o),n.onLoadSuccess(e,n,o),n.render(e,n,o)},error:function(){n.onLoadError(e,n)}})},onBeforeLoad:function(o,e){e.debug&&console.log("onBeforeLoad: 加载数据前"),e.query.offset=(e.pageIndex-1)*e.pageSize,e.query.limit=e.pageSize,e.isLoading&&e.onLoadStart()},onLoadSuccess:function(o,e,n){e.debug&&console.log("onLoadSuccess: 加载数据成功"),e.total=n.total,2==e.pageIndex&&(e.isOneShow=!1),e.total>e.pageIndex*e.pageSize?e.pageIndex++:e.isOver=!0,e.isLoading&&e.onLoadFinish()},onLoadError:function(o,e){e.debug&&console.log("onLoadError: 加载数据失败")},render:function(o,e,n){e.debug&&console.log("render: 数据渲染"),o.append(template(e.model,n)),e.isOver&&(e.isOneShow?e.initNoData&&o.append(e.initNoData):e.noData&&o.append(e.noData))},onLoadOver:function(o,e){e.debug&&console.log("onLoadOver: 没有数据可以加载了")}};e=o.extend(a,n);var i=o(this);return o(window).scroll(function(){var n=Math.ceil(o(window).height())+Math.ceil(o(window).scrollTop());o(document).height()<=n&&(0==e.isOver?i.MobileLoad("load"):e.onLoadOver(i,e))}),i.MobileLoad("init"),i},o.fn.MobileLoad.methods={init:function(o){e.query=e.queryParams(),o.MobileLoad("load")},load:function(o){e.onBeforeLoad(o,e),e.onLoad(o,e)},reLoad:function(o){e.pageIndex=1,e.isOver=!1,e.isOneShow=!0,o.html(""),o.MobileLoad("load")}}}(jQuery);