!function(o,e){function t(e,t){this.$element=o(e),this.opts=o.extend(!0,{},n,t),this.isLoading=!1,this.isOneShow=!0,this.isOver=!1,this.total=0,this.querys=this.opts.queryParams(),this.querys.pageSize=this.opts.pageSize,this.querys.limit=this.opts.pageSize,this._init()}o(e);var n={debug:!1,url:"",model:"",initNoData:"",noData:"",errorData:"",pageIndex:1,pageSize:10,queryParams:function(){return{}},onLoadBefore:function(e){o.loading()},onLoadSuccess:function(o,e){e.data.length<=0&&(o.isOver=!0)},onLoadFail:function(o,e){o.opts.errorData&&o.$element.append(o.opts.errorData)},onLoadComplete:function(e,t){o.loading()},onLoadOver:function(o){},onRender:function(o,e){var t=template(o.opts.model,e);o.$element.append(t)}};t.prototype={constructor:t,_init:function(){var o=this;o._doLoad(),o._doScroll()},_doLoad:function(){var e=this;e.isLoading=!0,e.querys.pageIndex=e.opts.pageIndex,e.querys.offset=(e.opts.pageIndex-1)*e.opts.pageSize,e.opts.debug&&(console.log("开始加载第--"+e.opts.pageIndex+"--页"),console.log("onLoadBefore: 数据加载前"),console.log(e)),e.opts.onLoadBefore(e),o.ajax({url:e.opts.url,type:"post",dataType:"json",data:e.querys}).done(function(o){e.opts.debug&&(console.log("onLoadSuccess: 数据加载成功"),console.log(o)),e._onLoadSuccess(o),e.opts.onLoadSuccess(e,o),0==e.isOver?(e.opts.pageIndex++,e.opts.onRender(e,o)):e._onNoDataRender(o),e.isLoading=!1}).fail(function(o){e.opts.debug&&console.log("onLoadFail: 数据加载失败"),e.opts.onLoadFail(e,o)}).always(function(o){e.opts.debug&&console.log("onLoadComplete: 数据加载完成"),e.opts.onLoadComplete(e,o)})},_doScroll:function(){var t=this;o(e).scroll(function(){var n=Math.ceil(o(e).height())+Math.ceil(o(e).scrollTop());o(document).height()<=n&&(0==t.isOver&&0==t.isLoading?(t.opts.debug&&console.log("滚动加载触发"),t._doLoad()):t.isOver&&(t.opts.debug&&console.log("onLoadOver: 已经结束"),t.opts.onLoadOver(t)))})},_onLoadSuccess:function(o){var e=this;e.total=o.total,e.opts.pageIndex>1&&(e.isOneShow=!1)},_onNoDataRender:function(o){var e=this;e.isOneShow&&e.opts.initNoData?e.$element.append(e.opts.initNoData):0==e.isOneShow&&e.opts.noData&&e.$element.append(e.opts.noData)},reLoad:function(){var e=this;e.$element.html(""),o("body").scrollTop(0),e.opts.pageIndex=1,e.isLoading=!1,e.isOneShow=!0,e.isOver=!1,e.total=0,e._init()}},"undefined"!=typeof module&&module.exports?module.exports=t:"function"==typeof define&&define.amd?define(function(){return t}):e.MobileLoad=t,o.fn.MobileLoad=function(o){return new t(this,o)}}(jQuery,window);